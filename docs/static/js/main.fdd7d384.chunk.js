(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,n){var i;i=function(){var e=function(e){return e.reduce(function(e,t){return 2*e+t},0)},t=function(e){for(var t=[],n=7;n>=0;n--)t.push(!!(e&1<<n));return t},n=function(e){this.data=e,this.len=this.data.length,this.pos=0,this.readByte=function(){if(this.pos>=this.data.length)throw new Error("Attempted to read past end of stream.");return e instanceof Uint8Array?e[this.pos++]:255&e.charCodeAt(this.pos++)},this.readBytes=function(e){for(var t=[],n=0;n<e;n++)t.push(this.readByte());return t},this.read=function(e){for(var t="",n=0;n<e;n++)t+=String.fromCharCode(this.readByte());return t},this.readUnsigned=function(){var e=this.readBytes(2);return(e[1]<<8)+e[0]}},i=function(n,i){i||(i={});var a=function(e){for(var t=[],i=0;i<e;i++)t.push(n.readBytes(3));return t},o=function(){var e,t;t="";do{e=n.readByte(),t+=n.read(e)}while(0!==e);return t},r=function(r){r.leftPos=n.readUnsigned(),r.topPos=n.readUnsigned(),r.width=n.readUnsigned(),r.height=n.readUnsigned();var s=t(n.readByte());r.lctFlag=s.shift(),r.interlaced=s.shift(),r.sorted=s.shift(),r.reserved=s.splice(0,2),r.lctSize=e(s.splice(0,3)),r.lctFlag&&(r.lct=a(1<<r.lctSize+1)),r.lzwMinCodeSize=n.readByte();var c=o();r.pixels=function(e,t){for(var n,i,a=0,o=function(e){for(var n=0,i=0;i<e;i++)t.charCodeAt(a>>3)&1<<(7&a)&&(n|=1<<i),a++;return n},r=[],s=1<<e,c=s+1,u=e+1,l=[],d=function(){l=[],u=e+1;for(var t=0;t<s;t++)l[t]=[t];l[s]=[],l[c]=null};;)if(i=n,(n=o(u))!==s){if(n===c)break;if(n<l.length)i!==s&&l.push(l[i].concat(l[n][0]));else{if(n!==l.length)throw new Error("Invalid LZW code.");l.push(l[i].concat(l[i][0]))}r.push.apply(r,l[n]),l.length===1<<u&&u<12&&u++}else d();return r}(r.lzwMinCodeSize,c),r.interlaced&&(r.pixels=function(e,t){for(var n=new Array(e.length),i=e.length/t,a=function(i,a){var o=e.slice(a*t,(a+1)*t);n.splice.apply(n,[i*t,t].concat(o))},o=[0,4,2,1],r=[8,8,4,2],s=0,c=0;c<4;c++)for(var u=o[c];u<i;u+=r[c])a(u,s),s++;return n}(r.pixels,r.width)),i.img&&i.img(r)},s=function a(){var s={};switch(s.sentinel=n.readByte(),String.fromCharCode(s.sentinel)){case"!":s.type="ext",function(a){switch(a.label=n.readByte(),a.label){case 249:a.extType="gce",function(a){n.readByte();var o=t(n.readByte());a.reserved=o.splice(0,3),a.disposalMethod=e(o.splice(0,3)),a.userInput=o.shift(),a.transparencyGiven=o.shift(),a.delayTime=n.readUnsigned(),a.transparencyIndex=n.readByte(),a.terminator=n.readByte(),i.gce&&i.gce(a)}(a);break;case 254:a.extType="com",function(e){e.comment=o(),i.com&&i.com(e)}(a);break;case 1:a.extType="pte",function(e){n.readByte(),e.ptHeader=n.readBytes(12),e.ptData=o(),i.pte&&i.pte(e)}(a);break;case 255:a.extType="app",function(e){switch(n.readByte(),e.identifier=n.read(8),e.authCode=n.read(3),e.identifier){case"NETSCAPE":!function(e){n.readByte(),e.unknown=n.readByte(),e.iterations=n.readUnsigned(),e.terminator=n.readByte(),i.app&&i.app.NETSCAPE&&i.app.NETSCAPE(e)}(e);break;default:!function(e){e.appData=o(),i.app&&i.app[e.identifier]&&i.app[e.identifier](e)}(e)}}(a);break;default:a.extType="unknown",function(e){e.data=o(),i.unknown&&i.unknown(e)}(a)}}(s);break;case",":s.type="img",r(s);break;case";":s.type="eof",i.eof&&i.eof(s);break;default:throw new Error("Unknown block: 0x"+s.sentinel.toString(16))}"eof"!==s.type&&setTimeout(a,0)};!function(){var o={};if(o.sig=n.read(3),o.ver=n.read(3),"GIF"!==o.sig)throw new Error("Not a GIF file.");o.width=n.readUnsigned(),o.height=n.readUnsigned();var r=t(n.readByte());o.gctFlag=r.shift(),o.colorRes=e(r.splice(0,3)),o.sorted=r.shift(),o.gctSize=e(r.splice(0,3)),o.bgColor=n.readByte(),o.pixelAspectRatio=n.readByte(),o.gctFlag&&(o.gct=a(1<<o.gctSize+1)),i.hdr&&i.hdr(o)}(),setTimeout(s,0)};return function(e){var t,a,o={vp_l:0,vp_t:0,vp_w:null,vp_h:null,c_w:null,c_h:null};for(var r in e)o[r]=e[r];o.vp_w&&o.vp_h&&(o.is_vp=!0);var s=null,c=!1,u=null,l=null,d=null,h=null,f=null,p=null,g=null,m=!0,v=!1,w=[],y=[],b=o.gif;"undefined"==typeof o.auto_play&&(o.auto_play=!b.getAttribute("rel:auto_play")||"1"==b.getAttribute("rel:auto_play"));var _,G,I,S,E=o.hasOwnProperty("on_end")?o.on_end:null,k=o.hasOwnProperty("loop_delay")?o.loop_delay:0,O=o.hasOwnProperty("loop_mode")?o.loop_mode:"auto",C=!o.hasOwnProperty("draw_while_loading")||o.draw_while_loading,j=!!C&&(!o.hasOwnProperty("show_progress_bar")||o.show_progress_bar),T=o.hasOwnProperty("progressbar_height")?o.progressbar_height:25,N=o.hasOwnProperty("progressbar_background_color")?o.progressbar_background_color:"rgba(255,255,255,0.4)",x=o.hasOwnProperty("progressbar_foreground_color")?o.progressbar_foreground_color:"rgba(255,0,22,.8)",P=function(){u=null,l=null,f=d,d=null,p=null},B=function(){try{i(t,X)}catch(e){M("parse")}},D=function(e,t){_.width=e*V(),_.height=t*V(),I.style.minWidth=e*V()+"px",S.width=e,S.height=t,S.style.width=e+"px",S.style.height=t+"px",S.getContext("2d").setTransform(1,0,0,1,0,0)},R=function(e,t,n){if(n&&j){var i,a,r,s=T;o.is_vp?v?(a=(o.vp_t+o.vp_h-s)/V(),s/=V(),i=o.vp_l/V()+e/t*(o.vp_w/V()),r=_.width/V()):(a=o.vp_t+o.vp_h-s,s=s,i=o.vp_l+e/t*o.vp_w,r=_.width):(a=(_.height-s)/(v?V():1),i=e/t*_.width/(v?V():1),r=_.width/(v?V():1),s/=v?V():1),G.fillStyle=N,G.fillRect(i,a,r-i,s),G.fillStyle=x,G.fillRect(0,a,i,s)}},M=function(e){s=e,a={width:b.width,height:b.height},w=[],G.fillStyle="black",G.fillRect(0,0,o.c_w?o.c_w:a.width,o.c_h?o.c_h:a.height),G.strokeStyle="red",G.lineWidth=3,G.moveTo(0,0),G.lineTo(o.c_w?o.c_w:a.width,o.c_h?o.c_h:a.height),G.moveTo(0,o.c_h?o.c_h:a.height),G.lineTo(o.c_w?o.c_w:a.width,0),G.stroke()},U=function(){p&&(w.push({data:p.getImageData(0,0,a.width,a.height),delay:l}),y.push({x:0,y:0}))},A=function(){var e=-1,t=0,n=function(t){e+=t,a()},i=function(){var i=!1,a=function(){null!==E&&E(b),t++,!1!==O||t<0?o():(i=!1,m=!1)},o=function t(){if(i=m){n(1);var o=10*w[e].delay;o||(o=100),0===(e+1+w.length)%w.length?(o+=k,setTimeout(a,o)):setTimeout(t,o)}};return function(){i||setTimeout(o,0)}}(),a=function(){var t;(e=parseInt(e,10))>w.length-1&&(e=0),e<0&&(e=0),t=y[e],S.getContext("2d").putImageData(w[e].data,t.x,t.y),G.globalCompositeOperation="copy",G.drawImage(S,0,0)};return{init:function(){s||(o.c_w&&o.c_h||G.scale(V(),V()),o.auto_play?i():(e=0,a()))},step:i,play:function(){m=!0,i()},pause:function(){m=!1},playing:m,move_relative:n,current_frame:function(){return e},length:function(){return w.length},move_to:function(t){e=t,a()}}}(),F=function(e){R(t.pos,t.data.length,e)},L=function(){},z=function(e,t){return function(n){e(n),F(t)}},X={hdr:z(function(e){D((a=e).width,a.height)}),gce:z(function(e){U(),P(),u=e.transparencyGiven?e.transparencyIndex:null,l=e.delayTime,d=e.disposalMethod}),com:z(L),app:{NETSCAPE:z(L)},img:z(function(e){p||(p=S.getContext("2d"));var t=w.length,n=e.lctFlag?e.lct:a.gct;t>0&&(3===f?null!==h?p.putImageData(w[h].data,0,0):p.clearRect(g.leftPos,g.topPos,g.width,g.height):h=t-1,2===f&&p.clearRect(g.leftPos,g.topPos,g.width,g.height));var i=p.getImageData(e.leftPos,e.topPos,e.width,e.height);e.pixels.forEach(function(e,t){e!==u&&(i.data[4*t+0]=n[e][0],i.data[4*t+1]=n[e][1],i.data[4*t+2]=n[e][2],i.data[4*t+3]=255)}),p.putImageData(i,e.leftPos,e.topPos),v||(G.scale(V(),V()),v=!0),C&&(G.drawImage(S,0,0),C=o.auto_play),g=e},!0),eof:function(e){U(),F(!1),o.c_w&&o.c_h||(_.width=a.width*V(),_.height=a.height*V()),A.init(),c=!1,q&&q(b)}},Y=function(){var e=b.parentNode,t=document.createElement("div");_=document.createElement("canvas"),G=_.getContext("2d"),I=document.createElement("div"),S=document.createElement("canvas"),t.width=_.width=b.width,t.height=_.height=b.height,I.style.minWidth=b.width+"px",t.className="jsgif",I.className="jsgif_toolbar",t.appendChild(_),t.appendChild(I),e.insertBefore(t,b),e.removeChild(b),o.c_w&&o.c_h&&D(o.c_w,o.c_h),W=!0},V=function(){return o.max_width&&a?o.max_width/a.width:1},W=!1,q=!1,H=function(e){return!c&&(q=e||!1,c=!0,w=[],P(),h=null,f=null,p=null,g=null,!0)};return{play:A.play,pause:A.pause,move_relative:A.move_relative,move_to:A.move_to,get_playing:function(){return m},get_canvas:function(){return _},get_canvas_scale:function(){return V()},get_loading:function(){return c},get_auto_play:function(){return o.auto_play},get_length:function(){return A.length()},get_current_frame:function(){return A.current_frame()},load_url:function(e,i){if(H(i)){var a=new XMLHttpRequest;a.open("GET",e,!0),"overrideMimeType"in a?a.overrideMimeType("text/plain; charset=x-user-defined"):"responseType"in a?a.responseType="arraybuffer":a.setRequestHeader("Accept-Charset","x-user-defined"),a.onloadstart=function(){W||Y()},a.onload=function(e){200!=this.status&&M("xhr - response"),"response"in this||(this.response=0);var i=this.response;i.toString().indexOf("ArrayBuffer")>0&&(i=new Uint8Array(i)),t=new n(i),setTimeout(B,0)},a.onprogress=function(e){e.lengthComputable&&R(e.loaded,e.total,!0)},a.onerror=function(){M("xhr")},a.send()}},load:function(e){this.load_url(b.getAttribute("rel:animated_src")||b.src,e)},load_raw:function(e,i){H(i)&&(W||Y(),t=new n(e),setTimeout(B,0))},set_frame_offset:function(e,t){y[e]?("undefined"!==typeof t.x&&(y[e].x=t.x),"undefined"!==typeof t.y&&(y[e].y=t.y)):y[e]=t}}}},e.exports=i()},18:function(e,t,n){e.exports=n(54)},26:function(e,t,n){},42:function(e,t,n){},44:function(e,t,n){},46:function(e,t,n){},48:function(e,t,n){},50:function(e,t,n){},52:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);n(19);var i=n(0),a=n.n(i),o=n(7),r=n.n(o),s=(n(26),n(16)),c=n(8),u=n(15),l=n(1),d=n(2),h=n(4),f=n(3),p=n(5),g=n(10),m=(n(42),n(44),function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"Results"},this.props.searchResults.map(function(t,n){return a.a.createElement("img",{className:"search-result-gif",key:n,src:t.images.fixed_height_small.url,onClick:function(){return e.props.onGifClick(t)}})}))}}]),t}(i.Component)),v=(n(46),function(e,t){fetch("http://api.giphy.com"+"/v1/gifs/search"+"?api_key="+"PrDuQjBTO5H7jg1eO1xj6sx5zGCsi4Y6"+"&q="+e,{cors:"cors",cache:"no-cache"}).then(function(e){return e.json()}).then(function(e){return t(e.data)})}),w=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).handleSearch=function(){v(n.state.query,function(e){n.setState({results:e,loading:!1})})},n.handleChange=function(e){n.setState({query:e.target.value}),null===n.searchTimeoutId&&clearTimeout(n.searchTimeoutId),""!==e.target.value?(n.searchTimeoutId=setTimeout(n.handleSearch,1500),n.setState({loading:!0})):n.setState({loading:!1})},n.state={query:"",loading:!1,results:[]},n.queryInput=a.a.createRef(),n.searchTimeoutId=null,n}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.open!==this.props.open&&this.props.open&&this.queryInput.current.focus()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){return this.props.open?a.a.createElement("div",{className:"giphy-search"},a.a.createElement("div",{className:"search-box"},a.a.createElement("input",{type:"text",placeholder:"enter a search term",value:this.state.query,onChange:this.handleChange,ref:this.queryInput,className:"query-input"})),a.a.createElement(m,{searchResults:this.state.query?this.state.results:this.props.previouslyUsedGifs,onGifClick:this.props.onGifClick}),a.a.createElement("h5",{className:"search-title"},"Choose a gif",this.state.loading?a.a.createElement("span",{className:"loading"},"  loading"):"")):""}}]),t}(i.Component),y=n(13),b=n.n(y),_=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).onEnd=function(){"once"===n.props.duration&&n.props.onEnd()},n.state={isReady:!1},n.element=a.a.createRef(),n.timeoutId=null,n}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.wrapper=new b.a({gif:this.element.current,auto_play:this.props.playing,progressbar_height:0,loop_mode:this.props.loop,on_end:this.onEnd,max_width:this.props.width}),this.wrapper.load(function(){return e.setState({isReady:!0})})}},{key:"componentDidUpdate",value:function(e,t){var n=this;e.playing!==this.props.playing&&this.state.isReady?this.props.playing?(this.wrapper.move_to(0),this.wrapper.play(),"5sec"!==this.props.duration||this.timeoutId||(this.timeoutId=setTimeout(function(){n.props.onEnd(),n.timeoutId=null},5e3))):(this.wrapper.pause(),clearTimeout(this.timeoutId)):this.props.playing&&!this.timeoutId&&"5sec"===this.props.duration&&(this.timeoutId=setTimeout(function(){n.props.onEnd(),n.timeoutId=null},5e3))}},{key:"render",value:function(){if(!this.props.src)return"";var e=this.props.src.slice(0,-"giphy.gif".length)+"200w.gif";return a.a.createElement("div",{style:this.props.style,className:this.props.className},a.a.createElement("img",{ref:this.element,src:e,alt:this.props.alt,width:this.props.width,height:"auto"}))}}]),t}(i.Component);_.defaultProps={autoPlay:!1,src:null,style:{},loop:!1,width:null,height:null,duration:"once"};var G=_,I=function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return this.props.gif?a.a.createElement(G,{className:"gif-player",src:this.props.gif.url,alt:"gif",style:{left:this.props.gif.positionX,width:this.props.width,top:this.props.gif.positionY,visibility:this.props.playing?"visible":"hidden"},playing:this.props.playing,duration:this.props.gif.duration,width:this.props.width,loop:"once"!==this.props.gif.duration,onEnd:this.props.onEnd}):""}}]),t}(a.a.Component),S=(n(48),function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"gif-bar"},this.props.showMarkers?this.props.gifs.map(function(e){return a.a.createElement("div",{className:"gif-marker",key:e.url+e.timeFraction,style:{marginLeft:100*e.timeFraction+"%"}})}):"")}}]),t}(a.a.Component)),E=(n(50),"http://gif-backend.herokuapp.com"),k="http://noembed.com/embed?url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D",O=(n(52),function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"video-info",style:{backgroundImage:"url("+this.props.videoInfo.thumbnail_url+")"},onClick:function(){window.location="?id="+e.props.videoId}},a.a.createElement("span",null,this.props.videoInfo.title))}}]),t}(i.Component)),C=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={videoInfo:null,loading:!0},n}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(k+this.props.videoId).then(function(e){return e.json()}).then(function(t){return e.setState({videoInfo:t,loading:!1})})}},{key:"render",value:function(){return!this.state.loading&&this.state.videoInfo.error?"":this.state.loading?a.a.createElement("div",{className:"video-info"},"Loading"):a.a.createElement(O,{videoInfo:this.state.videoInfo,videoId:this.props.videoId})}}]),t}(i.Component),j=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).hideList=function(e){e.preventDefault(),n.props.onHide&&n.props.onHide()},n.state={loading:!0,videoIds:[]},n}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(E+"/videos").then(function(e){return e.json()}).then(function(t){e.setState({videoIds:Array.from(new Set(t.map(function(e){return e.videoId}).filter(function(e){return e}))),loading:!1})})}},{key:"render",value:function(){return a.a.createElement("div",{className:"videos-list",style:{visibility:!this.props.visible&&"hidden"}},a.a.createElement("button",{href:"#",onClick:this.hideList,className:"hide-link"},"Hide"),this.state.loading&&a.a.createElement("div",{className:"results-loading"},"Loading"),this.state.videoIds.map(function(e){return a.a.createElement(C,{videoId:e})}))}}]),t}(i.Component),T=n(17),N=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).handleEsc=function(e){"Escape"===e.key&&n.setState({showGifSearch:!1})},n.handleDocumentClick=function(e){n.state.videoId&&n.showGifSearch&&!n.searchDiv.current.contains(e.target)&&n.setState({showGifSearch:!1})},n.serverGifToLocal=function(e){return{url:e.gifId,timeFraction:e.timestamp,fracX:e.fracX,fracY:e.fracY,serverId:e._id,scale:e.scale,duration:e.duration}},n.fetchGifs=function(){return fetch(E+"/gifs?videoId="+n.state.videoId).then(function(e){return e.json()}).then(function(e){return e.gifs.map(n.serverGifToLocal)})},n.getVideoDuration=function(e){return n.player.current.internalPlayer.getDuration()},n.onPlayerReady=function(){n.intervalId=setInterval(n.timer,100),Promise.all([n.fetchGifs(),n.getVideoDuration()]).then(function(e){var t=Object(u.a)(e,2),i=t[0],a=t[1];n.setState({gifs:n.computeGifPositions(i).sort(function(e,t){return e.timeFraction-t.timeFraction}),videoDuration:a})})},n.onPlayerStateChange=function(e){1===e.data?(n.setState({videoPlaying:!0}),clearTimeout(n.gifBarTimeoutId),n.gifBarTimeoutId=setTimeout(function(){return n.setState({showGifBar:!1})},4e3)):(n.setState({showGifBar:!0,videoPlaying:!1}),clearTimeout(n.gifBarTimeoutId))},n.onMouseMove=function(e){n.state.videoPlaying&&(clearTimeout(n.gifBarTimeoutId),n.setState({showGifBar:!0}),n.gifBarTimeoutId=setTimeout(function(){return n.setState({showGifBar:!1})},2e3))},n.timer=function(){try{n.player.current.internalPlayer.getCurrentTime().then(function(e){n.setState({currentVideoTime:e}),n.setState(function(t){var n=t.gifs,i=t.videoDuration,a=!1,o=n.map(function(t){return Math.abs(e-t.timeFraction*i)<.15?(a=!0,Object.assign(t,{playing:!0})):t});if(a)return{gifs:o}})})}catch(e){clearInterval(n.intervalId)}},n.gifEnded=function(e){n.setState(function(t){var n=t.gifs,i=n.findIndex(function(t){return t.url===e.url&&t.timeFraction===e.timeFraction});return-1===i?n:{gifs:Object(c.a)(n.slice(0,i)).concat([Object.assign(e,{playing:!1})],Object(c.a)(n.slice(i+1)))}})},n.toggleGifSearch=function(){n.setState(function(e){return{showGifSearch:!e.showGifSearch}})},n.closeGifSearch=function(){n.setState({showGifSearch:!1})},n.handleCancel=function(){n.setState({newGif:null,showGifSearch:!1})},n.addNewGif=function(e){n.setState(function(t){var n=t.previouslyUsedGifs;return n.includes(e)?{newGif:e,showGifSearch:!1}:{newGif:e,showGifSearch:!1,previouslyUsedGifs:[e].concat(Object(c.a)(n))}},function(){return localStorage.setItem("usedGifs",JSON.stringify(n.state.previouslyUsedGifs))}),n.player.current.internalPlayer.pauseVideo()},n.postNewGif=function(e){fetch(E+"/gifs",{method:"post",cache:"no-cache",cors:"cors",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({videoId:e.videoId,gifId:e.url,gifTimestamp:e.timeFraction,fracX:e.fracX,fracY:e.fracY,scale:e.scale,duration:e.duration})})},n.getRealVideoDimensions=function(){var e=r.a.findDOMNode(n.player.current).children[0].getBoundingClientRect(),t=Math.min(e.width/n.state.videoInfo.width,e.height/n.state.videoInfo.height);return{width:t*n.state.videoInfo.width,height:t*n.state.videoInfo.height}},n.computeGifPositions=function(e){var t=n.getRealVideoDimensions(),i=r.a.findDOMNode(n.player.current).children[0].getBoundingClientRect();return e.map(function(e){var n=Math.min(Math.max(e.fracX*t.width+i.width/2,0),i.width-100),a=Math.min(Math.max(e.fracY*t.height+i.height/2,0),i.height-100);return Object(s.a)({},e,{positionX:n,positionY:a})})},n.updateGifPositions=function(){n.setState(function(e){var t=e.gifs;return{gifs:n.computeGifPositions(t)}})},n.onWindowResize=function(){n.updateGifPositions()},n.saveNewGif=function(){var e=n.state.newGif,t="https://media.giphy.com/media/".concat(e.id,"/giphy.gif"),i=n.state.currentVideoTime,a=n.state.videoId,o=n.getRealVideoDimensions(),s=r.a.findDOMNode(n.player.current).children[0].getBoundingClientRect(),c={url:t,time:i,videoId:a,fracX:(n.state.newGifX-s.width/2)/o.width,fracY:(n.state.newGifY-s.height/2)/o.height,scale:n.newGifRnd.current.getBoundingClientRect().width/o.width,duration:n.state.newGifDuration,positionX:n.state.newGifX,positionY:n.state.newGifY,timeFraction:i/n.state.videoDuration};n.postNewGif(c),n.setState({gifs:n.state.gifs.concat([c]),newGif:null,newGifX:0,newGifY:0,newGifSize:{width:!1,height:!1},newGifDuration:"once"})},n.state={gifs:[],videoId:n.props.urlParams.get("id"),videoInfo:null,videoDuration:null,videoPlaying:!1,newGif:null,newGifX:0,newGifY:0,newGifSize:{width:!1,height:!1},newGifDuration:"once",previouslyUsedGifs:JSON.parse(localStorage.getItem("usedGifs"))||[],showGifSearch:!1,showAddGif:!1,showGifBar:!0,showVideosList:!1},n.player=a.a.createRef(),n.searchDiv=a.a.createRef(),n.newGifRnd=a.a.createRef(),document.addEventListener("mousedown",n.handleDocumentClick,!1),document.addEventListener("keydown",n.handleEsc,!1),window.addEventListener("resize",n.onWindowResize,!1),n}return Object(p.a)(t,e),Object(d.a)(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleDocumentClick,!1),document.removeEventListener("keydown",this.handleEsc,!1),window.removeEventListener("resize",this.onWindowResize,!1),clearInterval(this.intervalId)}},{key:"componentDidMount",value:function(){var e=this;this.state.videoId?(fetch(E+"/videos",{method:"post",cache:"no-cache",cors:"cors",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({videoId:this.state.videoId})}),fetch(k+this.state.videoId).then(function(e){return e.json()}).then(function(t){return e.setState({videoInfo:t})})):window.location="?id=dQw4w9WgXcQ"}},{key:"render",value:function(){var e=this;return null===this.state.videoId?a.a.createElement("div",{className:"App"},"Please enter video id in the url. Like this: ",a.a.createElement("a",{href:"?id=dQw4w9WgXcQ"},"?id=dQw4w9WgXcQ"),"."):a.a.createElement("div",{className:"App container"},a.a.createElement(j,{onHide:function(){return e.setState({showVideosList:!1})},visible:this.state.showVideosList}),a.a.createElement("div",{className:"header"},a.a.createElement("h1",null,"Gifgif"),a.a.createElement("button",{className:"show-videos-list",onClick:function(){return e.setState({showVideosList:!0})}},"Other videos"),this.state.newGif?a.a.createElement("button",{type:"button",className:"btn btn-success save-gif-button",onClick:this.saveNewGif},"Save"):"",this.state.showGifSearch||this.state.newGif?a.a.createElement("button",{type:"button",className:"btn btn-danger add-gif-button",onClick:this.handleCancel},"Cancel"):a.a.createElement("button",{type:"button",className:"btn btn-primary add-gif-button",onClick:this.toggleGifSearch},"Add gif"),this.state.newGif&&a.a.createElement("div",{className:"choose-duration"},a.a.createElement("span",{className:"play-label"},"Choose place and time for the gif. Play gif"),a.a.createElement("div",{className:"btn-group btn-group-toggle","data-toggle":"buttons"},a.a.createElement("button",{className:"btn btn-sm btn-primary "+("once"===this.state.newGifDuration?"active":""),onClick:function(){return e.setState({newGifDuration:"once"})}},"once"),a.a.createElement("button",{className:"btn btn-sm btn-primary"+("once"!==this.state.newGifDuration?" active":""),onClick:function(){return e.setState({newGifDuration:"5sec"})}},"for 5 seconds")))),a.a.createElement("div",{className:"videoFrame",onMouseMove:this.onMouseMove},a.a.createElement(g.a,{videoId:this.state.videoId,opts:{width:"100%",height:"100%",playerVars:{autoplay:1}},ref:this.player,onReady:this.onPlayerReady,onStateChange:this.onPlayerStateChange}),this.state.newGif&&a.a.createElement("div",{className:"protective-screen"}),this.state.newGif?a.a.createElement(T.a,{bounds:"parent",lockAspectRatio:!0,onDragStop:function(t,n){return e.setState({newGifX:n.x,newGifY:n.y})},onResize:function(t,n,i){return e.setState({newGifSize:i.getBoundingClientRect()})}},a.a.createElement("img",{src:this.state.newGif.images.fixed_height_small.url,style:{width:this.state.newGifSize.width||"100%",height:this.state.newGifSize.height||"100%"},ref:this.newGifRnd})):"",a.a.createElement(S,{gifs:this.state.gifs,showMarkers:this.state.showGifBar}),a.a.createElement("div",{ref:this.searchDiv},a.a.createElement(w,{onGifClick:this.addNewGif,previouslyUsedGifs:this.state.previouslyUsedGifs,open:this.state.showGifSearch,closeGifSearch:this.closeGifSearch})),this.state.gifs.map(function(t){return a.a.createElement(I,{gif:t,key:t.url+t.timeFraction,width:t.scale*e.getRealVideoDimensions().width||200,playing:t.playing,onEnd:function(){return e.gifEnded(t)}})})))}}]),t}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var x=new URLSearchParams(window.location.search);r.a.render(a.a.createElement(N,{urlParams:x}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,2,1]]]);
//# sourceMappingURL=main.fdd7d384.chunk.js.map